name: Keep Streamlit App Alive

on:
  schedule:
    # Every hour from 7am-10pm PST (15:00-06:00 UTC, spanning two days)
    # 7am PST = 15:00 UTC, 10pm PST = 06:00 UTC next day
    - cron: "0 15-23 * * *"  # 3pm-11pm UTC (7am-3pm PST)
    - cron: "0 0-6 * * *"    # Midnight-6am UTC (4pm-10pm PST previous day)
  workflow_dispatch:  # Allow manual trigger for testing

permissions: {}  # No permissions needed for simple HTTP ping

jobs:
  keepalive:
    runs-on: ubuntu-latest
    steps:
      - name: Ping Streamlit app
        run: |
          curl --fail --silent --show-error --max-time 10 \
            -A "streamlit-keepalive-bot" \
            "https://creative-direction-decks.streamlit.app/?healthcheck=1" || true
        
      - name: Log ping result
        if: always()
        run: echo "Keep-alive ping completed at $(date -u +"%Y-%m-%d %H:%M:%S UTC")"
